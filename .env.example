# MCP Agent LangChain.js + Datadog - Environment Configuration
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# ============================================================================
# Required Secrets
# ============================================================================

# OpenAI API Key - Required for LLM operations
OPENAI_API_KEY=sk-...

# Datadog API Key - Required for APM and monitoring
DD_API_KEY=your-datadog-api-key

# PostgreSQL Database Password
POSTGRES_PASSWORD=changeme123

# JWT Secret for session tokens (generate a secure random string)
JWT_SECRET=your-secure-jwt-secret-here

# ============================================================================
# Optional Secrets
# ============================================================================

# Vertex AI Key (if using Vertex AI instead of OpenAI)
# VERTEX_AI_KEY=your-vertex-ai-key

# GCP Service Account Key (path to JSON file or JSON string)
# GCP_SA_KEY_FILE=/path/to/service-account-key.json
# GCP_SA_KEY_JSON={"type":"service_account",...}

# Azure OpenAI (legacy - optional)
# AZURE_OPENAI_API_ENDPOINT=https://your-resource.openai.azure.com
# AZURE_OPENAI_MODEL=gpt-4o-mini

# ============================================================================
# GCP Configuration
# ============================================================================

# GCP Project ID
PROJECT_ID=your-gcp-project-id

# Legacy variable names (for backward compatibility)
GCP_PROJECT_ID=${PROJECT_ID}

# GKE Cluster Configuration
CLUSTER_NAME=mcp-agent-cluster
REGION=us-central1-a

# Container Registry
REGISTRY=gcr.io/${PROJECT_ID}

# Firestore (legacy - optional)
FIRESTORE_DATABASE=(default)

# Google Cloud Storage Buckets
GCS_BUCKET=mcp-agent-burgers-data
GCS_IMAGES_BUCKET=mcp-agent-burgers-images

# ============================================================================
# Service URLs (for local development)
# ============================================================================

# Internal service URLs (use localhost for local dev)
BURGER_API_URL=http://localhost:7071
BURGER_MCP_URL=http://localhost:3000/mcp
AGENT_API_URL=http://localhost:8080

# Public-facing URLs (used in deployed environments)
AGENT_WEBAPP_URL=https://dev.platform-engineering-demo.dev
BURGER_WEBAPP_URL=https://burgers-dev.platform-engineering-demo.dev
PUBLIC_BASE_URL=https://burger-api-dev.platform-engineering-demo.dev

# ============================================================================
# Application Settings
# ============================================================================

NODE_ENV=development
LOG_LEVEL=info
PORT=8080

# Allow anonymous authentication (useful for development)
ALLOW_ANONYMOUS_AUTH=true

# ============================================================================
# PostgreSQL Database Configuration
# ============================================================================

POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=burgerapp
POSTGRES_DB=burgerdb
# POSTGRES_PASSWORD is defined above in Required Secrets

# ============================================================================
# Datadog Configuration
# ============================================================================

# Environment name (dev, staging, prod)
DD_ENV=dev

# Service name (will be overridden per service)
DD_SERVICE=agent-api

# Version for tracking deployments
DD_VERSION=1.0.0

# Datadog Site (US: datadoghq.com, EU: datadoghq.eu)
DD_SITE=datadoghq.com

# Enable log injection (add trace IDs to logs)
DD_LOGS_INJECTION=true

# Enable APM tracing
DD_TRACE_ENABLED=true

# Enable continuous profiling
DD_PROFILING_ENABLED=true

# Enable runtime metrics collection
DD_RUNTIME_METRICS_ENABLED=true

# LLM Observability Configuration
DD_LLMOBS_ENABLED=true
DD_LLMOBS_AGENTLESS_ENABLED=false
DD_LLMOBS_ML_APP=contoso-burgers-agent

# ============================================================================
# Azure (Legacy - Optional)
# ============================================================================

# Azure Cosmos DB (replaced by PostgreSQL)
# AZURE_COSMOSDB_NOSQL_ENDPOINT=https://your-account.documents.azure.com:443/

# Azure Application Insights (replaced by Datadog)
# APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=...

# Azure Storage (replaced by local file system)
# AZURE_STORAGE_URL=https://your-account.blob.core.windows.net
# AZURE_STORAGE_CONTAINER_NAME=blobs

# ============================================================================
# Development & Testing
# ============================================================================

# Custom handler port (for Azure Functions compatibility)
FUNCTIONS_CUSTOMHANDLER_PORT=3000

# ============================================================================
# Deployment Environment Variables (set by Kubernetes)
# ============================================================================

# These are set automatically in Kubernetes via ConfigMaps and Secrets
# and are listed here for reference only:
#
# From ConfigMap (k8s/base/configmap.yaml):
# - BURGER_API_URL
# - BURGER_MCP_URL
# - AGENT_API_URL
# - PUBLIC_BASE_URL
# - POSTGRES_HOST (points to StatefulSet)
# - DD_ENV, DD_SERVICE, DD_VERSION, DD_SITE
# - DD_LOGS_INJECTION, DD_TRACE_ENABLED, DD_PROFILING_ENABLED
# - DD_RUNTIME_METRICS_ENABLED, DD_LLMOBS_ENABLED
#
# From Secret (generated by k8s/scripts/generate-secrets.sh):
# - OPENAI_API_KEY (from env var)
# - DD_API_KEY (from env var)
# - POSTGRES_PASSWORD (hardcoded in script)

# ============================================================================
# Usage Notes
# ============================================================================

# For local development:
# 1. Copy this file to .env
# 2. Fill in OPENAI_API_KEY and DD_API_KEY
# 3. Start PostgreSQL: docker-compose up -d postgres
# 4. Run services: npm start

# For Kubernetes deployment:
# 1. Export OPENAI_API_KEY and DD_API_KEY
# 2. Run: make secrets-generate ENV=dev
# 3. Deploy: make deploy ENV=dev

# Security:
# - Never commit .env to git
# - Rotate secrets regularly
# - Use different secrets for dev/prod
# - Store production secrets in secure vault

# ============================================================================
# GitHub Actions CI/CD
# ============================================================================

# For automated deployments via GitHub Actions, see .env.github.example
# The GitHub Actions workflow requires different variables for CI/CD:
#
# - GCP_PROJECT_ID, GKE_CLUSTER, GKE_ZONE
# - GAR_LOCATION, GAR_REPOSITORY (Artifact Registry)
# - WIF_PROVIDER, WIF_SERVICE_ACCOUNT (Workload Identity)
# - All application secrets above
#
# Setup instructions:
# 1. Copy .env.github.example to .env.github
# 2. Run: ./scripts/setup-github-secrets.sh --generate
# 3. Fill in values in .env.github
# 4. Run: ./scripts/setup-github-secrets.sh --auto --env-file .env.github
#
# See docs/deployment/CICD_QUICKSTART.md for details

# ============================================================================
# Password Generation
# ============================================================================

# Generate secure passwords with:
#   ./scripts/setup-github-secrets.sh --generate
#
# This will create:
# - POSTGRES_PASSWORD: 25-character random string
# - JWT_SECRET: 50-character random string
